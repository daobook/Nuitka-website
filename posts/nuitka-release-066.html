<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />    <link rel="icon" href="../_static/favicon.svg" type="image/svg+xml">
    <link rel="icon" href="../_static/favicon.png" sizes="32x32" type="image/png">
    <link rel="icon" href="../_static/favicon.ico" sizes="32x32" type="image/x-icon">
    <link rel="icon" href="../_static/apple-touch-icon-iphone.png" sizes="57x57" type="image/png">
    <link rel="icon" href="../_static/apple-touch-icon-ipad.png" sizes="72x72" type="image/png">
    <link rel="icon" href="../_static/apple-touch-icon-iphone4.png" sizes="114x114" type="image/png">
    <link rel="icon" href="../_static/apple-touch-icon-ipad3.png" sizes="144x144" type="image/png">
    <link rel="apple-touch-icon" href="../_static/apple-touch-icon-180x180.png" sizes="180x180" type="image/png">

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Nuitka Release 0.6.6</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/my_theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/design-style.59c74d8c95b765a7fd995ac71d459ebe.min.css" type="text/css" />
    <link rel="canonical" href="https://nuitka.net/posts/nuitka-release-066.html" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script src="../_static/design-tabs.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />   
<link
  rel="alternate"
  type="application/atom+xml"
  href="../blog/atom.xml"
  title="Nuitka Blog"
/>
 
<style type="text/css">
  ul.ablog-archive {
    list-style: none;
    overflow: auto;
    margin-left: 0px;
  }
  ul.ablog-archive li {
    float: left;
    margin-right: 5px;
    font-size: 80%;
  }
  ul.postlist a {
    font-style: italic;
  }
  ul.postlist-style-disc {
    list-style-type: disc;
  }
  ul.postlist-style-none {
    list-style-type: none;
  }
  ul.postlist-style-circle {
    list-style-type: circle;
  }
</style>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> Nuitka the Python Compiler
          </a><!-- Empty override file take the place of searchbox.html, which generates search box. -->
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../doc/download.html">Download</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/support.html">Support</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Commercial Users</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../doc/commercial.html">Nuitka Commercial</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Release Information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../doc/Changelog.html">Nuitka Release 0.6.20 (Draft)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc/Changelog.html#nuitka-release-0-6-19">Nuitka Release 0.6.19</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc/Changelog.html#nuitka-release-0-6-18">Nuitka Release 0.6.18</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc/Changelog.html#older-releases">Older Releases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc/roadmap.html">Roadmap</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">More documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../doc/api-doc.html">API doc</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc/factory.html">Factory Instructions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Media</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../pages/Presentations.html">Presentations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/Streaming.html">Streaming</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Other</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../pages/impressum.html">Impressum</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Under construction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../doc/welcome.html">Welcome</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/pyside2.html">Nuitka PySide2 support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/donations.html">Donations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/gsoc2019.html">Google Summer of Code 2019</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Nuitka the Python Compiler</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <!-- Empty override file take the place of sphinx_rtd_theme/breadcrumbs.html, which generates the top nav breadcrumbs. -->
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
              <div class="section" id="nuitka-release-0-6-6">
<h1>Nuitka Release 0.6.6<a class="headerlink" href="#nuitka-release-0-6-6" title="Permalink to this headline"></a></h1>
<p>This is to inform you about the new stable release of <a class="reference external" href="https://nuitka.net">Nuitka</a>. It is the extremely compatible Python compiler,
<a class="reference external" href="/doc/download.html">“download now”</a>.</p>
<p>This release contains huge amounts of crucial bug fixes all across the
board. There is also new optimization and many organisational
improvements.</p>
<div class="section" id="bug-fixes">
<h2>Bug Fixes<a class="headerlink" href="#bug-fixes" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p>Fix, the top level module must not be bytecode. Otherwise we end up
violating the requirement for an entry point on the C level.</p></li>
<li><p>Fix, avoid optimizing calls with default values used. This is not yet
working and needed to be disabled for now.</p></li>
<li><p>Python3: Fix, missing keyword only arguments were not enforced to be
provided keyword only, and were not giving the compatible error
message when missing.</p></li>
<li><p>Windows: Find <code class="docutils literal notranslate"><span class="pre">win32com</span></code> DLLs too, even if they live in sub folders
of site-packages, and otherwise not found. They are used by other
DLLs that are found.</p></li>
<li><p>Standalone: Fixup for problem with standard library module in most
recent Anaconda versions.</p></li>
<li><p>Scons: Fix, was using <code class="docutils literal notranslate"><span class="pre">CXXFLAGS</span></code> and <code class="docutils literal notranslate"><span class="pre">CPPFLAGS</span></code> even for the C
compiler, which is wrong, and could lead to compilation errors.</p></li>
<li><p>Windows: Make <code class="docutils literal notranslate"><span class="pre">--clang</span></code> limited to <code class="docutils literal notranslate"><span class="pre">clang-cl.exe</span></code> as using it
inside a MinGW64 is not currently supported.</p></li>
<li><p>Standalone: Added support for using <code class="docutils literal notranslate"><span class="pre">lib2to2.pgen</span></code>.</p></li>
<li><p>Standalone: Added paths used by openSUSE to the Tcl/Tk plugin.</p></li>
<li><p>Python3.6+: Fix, the <code class="docutils literal notranslate"><span class="pre">__main__</span></code> package was <code class="docutils literal notranslate"><span class="pre">None</span></code>, but should be
<code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code> which allows relative imports from itself.</p></li>
<li><p>Python2: Fix, compile time optimization of floor division was using
normal division.</p></li>
<li><p>Python3: Fix, some run time operations with known type shapes, were
falsely reporting error message with <code class="docutils literal notranslate"><span class="pre">unicode</span></code> or <code class="docutils literal notranslate"><span class="pre">long</span></code>, which
is of course not compatible.</p></li>
<li><p>Fix, was caching parent package, but these could be replaced e.g. due
to bytecode demotion later, causing crashes during their
optimization.</p></li>
<li><p>Fix, the value of <code class="docutils literal notranslate"><span class="pre">__compiled__</span></code> could be corrupted when being
deleted, which some modules wrappers do.</p></li>
<li><p>Fix, the value of <code class="docutils literal notranslate"><span class="pre">__package__</span></code> could be corrupted when being
deleted.</p></li>
<li><p>Scons: Make sure we can always output the compiler output, even if it
has a broken encoding. This should resolve MSVC issues on non-English
systems, e.g. German or Chinese.</p></li>
<li><p>Standalone: Support for newest <code class="docutils literal notranslate"><span class="pre">sklearn</span></code> was added.</p></li>
<li><p>macOS: Added resolver for run time variables in <code class="docutils literal notranslate"><span class="pre">otool</span></code> output,
that gets PyQt5 to work on it again.</p></li>
<li><p>Fix, floor division of run time calculations with float values should
not result in <code class="docutils literal notranslate"><span class="pre">int</span></code>, but <code class="docutils literal notranslate"><span class="pre">float</span></code> values instead.</p></li>
<li><p>Standalone: Enhanced support for <code class="docutils literal notranslate"><span class="pre">boto3</span></code> data files.</p></li>
<li><p>Standalone: Added support for <code class="docutils literal notranslate"><span class="pre">osgeo</span></code> and <code class="docutils literal notranslate"><span class="pre">gdal</span></code>.</p></li>
<li><p>Windows: Fix, there were issues with spurious errors attaching the
constants blob to the binary due to incorrect C types provided.</p></li>
<li><p>Distutils: Fix, need to allow <code class="docutils literal notranslate"><span class="pre">/</span></code> as separator for package names
too.</p></li>
<li><p>Python3.6+: Fix reference losses in asyncgen when throwing exceptions
into them.</p></li>
<li><p>Standalone: Added support for <code class="docutils literal notranslate"><span class="pre">dill</span></code>.</p></li>
<li><p>Standalone: Added support for <code class="docutils literal notranslate"><span class="pre">scikit-image</span></code> and <code class="docutils literal notranslate"><span class="pre">skimage</span></code>.</p></li>
<li><p>Standalone: Added support for <code class="docutils literal notranslate"><span class="pre">weasyprint</span></code>.</p></li>
<li><p>Standalone: Added support for <code class="docutils literal notranslate"><span class="pre">dask</span></code>.</p></li>
<li><p>Standalone: Added support for <code class="docutils literal notranslate"><span class="pre">pendulum</span></code>.</p></li>
<li><p>Standalone: Added support for <code class="docutils literal notranslate"><span class="pre">pytz</span></code> and <code class="docutils literal notranslate"><span class="pre">pytzdata</span></code>.</p></li>
<li><p>Fix, <code class="docutils literal notranslate"><span class="pre">--python-flags=no_docstrings</span></code> no longer implies disabling the
assertions.</p></li>
</ul>
</div>
<div class="section" id="new-features">
<h2>New Features<a class="headerlink" href="#new-features" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p>Added experimental support for Python 3.8, there is only very few
things missing for full support.</p></li>
<li><p>Distutils: Added support for packages that are in a namespace and not
just top level.</p></li>
<li><p>Distutils: Added support for single modules, not only packages, by
supporting <code class="docutils literal notranslate"><span class="pre">py_modules</span></code> as well.</p></li>
<li><p>Distutils: Added support for distinct namespaces.</p></li>
<li><p>Windows: Compare Python and C compiler architecture for MSVC too, and
catch the most common user error of mixing 32 and 64 bits.</p></li>
<li><p>Scons: Output variables used from the outside, so the debugging is
easier.</p></li>
<li><p>Windows: Detect if clang installed inside MSVC automatically and use
it if requested via <code class="docutils literal notranslate"><span class="pre">--clang</span></code> option. This is only the 32 bits
variant, but currently the easy way to use it on Windows with Nuitka.</p></li>
</ul>
</div>
<div class="section" id="optimization">
<h2>Optimization<a class="headerlink" href="#optimization" title="Permalink to this headline"></a></h2>
<ul>
<li><p>Loop variables were analysed, but results were only available on the
inside of the loop, preventing many optimization in these cases.</p></li>
<li><p>Added optimization for the <code class="docutils literal notranslate"><span class="pre">abs</span></code> built-in, which is also a
numerical operator.</p></li>
<li><p>Added optimization for the <code class="docutils literal notranslate"><span class="pre">all</span></code> built-in, adding a new concept of
iteration handle, for efficient checking that avoids looking at very
large sequences, of which properties can still be known.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">all</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100000</span><span class="p">))</span>  <span class="c1"># no need to look at all of them</span>
</pre></div>
</div>
</li>
<li><p>Added support for optimizing <code class="docutils literal notranslate"><span class="pre">ImportError</span></code> construction with
keyword-only arguments. Previously only used without these were
optimized.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s2">&quot;lala&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;lele&quot;</span><span class="p">)</span>  <span class="c1"># now optimized</span>
</pre></div>
</div>
</li>
<li><p>Added manual specialization for single argument calls, sovling a
TODO, as these will be very frequent.</p></li>
<li><p>Memory: Use single child form of node class where possible, the
general class now raises an error if used with used with only one
child name, this will use less memory at compile time.</p></li>
<li><p>Memory: Avoid list for non-local declarations in every function,
these are very rare, only have it if absolutely necessary.</p></li>
<li><p>Generate more compact code for potential <code class="docutils literal notranslate"><span class="pre">NameError</span></code> exceptions
being raised. These are very frequent, so this improves scalability
with large files.</p></li>
<li><p>Python2: Annotate comparison of <code class="docutils literal notranslate"><span class="pre">None</span></code> with <code class="docutils literal notranslate"><span class="pre">int</span></code> and <code class="docutils literal notranslate"><span class="pre">str</span></code>
types as not raising an exception.</p></li>
<li><p>Shared empty body functions and generators.</p>
<p>One shared implementation for all empty functions removes that burden
from the C compiler, and from the CPU instruction cache. All the
shared C code does is to release its arguments, or to return an empty
generator function in case of generator.</p>
</li>
<li><p>Memory: Added support for automatic releases of parameter variables
from the node tree. These are normally released in a try finally
block, however, this is now handled during code generation for much
more compact C code generated.</p></li>
<li><p>Added specialization for <code class="docutils literal notranslate"><span class="pre">int</span></code> and <code class="docutils literal notranslate"><span class="pre">long</span></code> operations <code class="docutils literal notranslate"><span class="pre">%</span></code>,
<code class="docutils literal notranslate"><span class="pre">&lt;&lt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&gt;&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">|</span></code>, <code class="docutils literal notranslate"><span class="pre">&amp;</span></code>, <code class="docutils literal notranslate"><span class="pre">^</span></code>, <code class="docutils literal notranslate"><span class="pre">**</span></code>, <code class="docutils literal notranslate"><span class="pre">&#64;</span></code>.</p></li>
<li><p>Added dedicated nodes for representing and optimizing based on shapes
for all binary operations.</p></li>
<li><p>Disable gcc macro tracing unless in debug mode, to save memory during
the C compilation.</p></li>
<li><p>Restored Python2 fast path for <code class="docutils literal notranslate"><span class="pre">int</span></code> with unknown object types,
restoring performance for these.</p></li>
</ul>
</div>
<div class="section" id="cleanups">
<h2>Cleanups<a class="headerlink" href="#cleanups" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p>Use dedicated <code class="docutils literal notranslate"><span class="pre">ModuleName</span></code> type that makes the tests that check if
a given module name is inside a namespace as methods. This was hard
to get right and as a result, adopting this fixed a few bugs and or
inconsistent results.</p></li>
<li><p>Expand the use of <code class="docutils literal notranslate"><span class="pre">nuitka.PostProcessing</span></code> to cover all actions
needed to get a runnable binary. This includes using
<code class="docutils literal notranslate"><span class="pre">install_name_tool</span></code> on macOS standalone, as well copying the Python
DLL for acceleration mode, cleaning the <code class="docutils literal notranslate"><span class="pre">x</span></code> bit for module mode.
Previously only a part of these lived there.</p></li>
<li><p>Avoid including the definitions of dynamically created helper
functions in the C code, instead just statically declare the ones
expected to be there. This resolves Visual Code complaining about it,
and should make life also easier for the compiler and caches like
<code class="docutils literal notranslate"><span class="pre">ccache</span></code>.</p></li>
<li><p>Create more helper code in closer form to what <code class="docutils literal notranslate"><span class="pre">clang-format</span></code> does,
so they are easier to compare to the static forms. We often create
hard coded variants for few arguments of call functions, and generate
them for many argument variations.</p></li>
<li><p>Moved setter/getter methods for Nuitka nodes consistently to the
start of the node class definitions.</p></li>
<li><p>Generate C code much closer to what <code class="docutils literal notranslate"><span class="pre">clang-format</span></code> would change it
to be.</p></li>
<li><p>Unified calling <code class="docutils literal notranslate"><span class="pre">install_name_tool</span></code> on macOS into one function that
takes care of all the things, including e.g. making the file
writable.</p></li>
<li><p>Debug output from scons should be more consistent and complete now.</p></li>
<li><p>Sort files for compilation in scons for better reproducible results.</p></li>
<li><p>Create code objects version independent, avoiding python version
checks by pre-processor, hiding new stuff behind macros, that ignore
things on older Python versions.</p></li>
</ul>
</div>
<div class="section" id="tests">
<h2>Tests<a class="headerlink" href="#tests" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p>Added many more built-in tests for increased coverage of the newly
covered ones, some of them being generic tests that allow to test all
built-ins with typical uses.</p></li>
<li><p>Many tests have become more PyLint clean as a result of work with
Visual Code and it complaining about them.</p></li>
<li><p>Added test to check PyPI health of top 50 packages. This is a major
GSoC 2019 result.</p></li>
<li><p>Output the standalone directory contents for Windows too in case of a
failure.</p></li>
<li><p>Added generated tests to fully cover operations on different type
shapes and their errors as well as results for typical values.</p></li>
<li><p>Added support for testing against installed version of Nuitka.</p></li>
<li><p>Cleanup up tests, merging those for only Python 3.2 with 3.3 as we no
longer support that version anyway.</p></li>
<li><p>Execute the Python3 tests for macOS on Travis too.</p></li>
</ul>
</div>
<div class="section" id="organisational">
<h2>Organisational<a class="headerlink" href="#organisational" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p>The donation sponsored machine called <code class="docutils literal notranslate"><span class="pre">donatix</span></code> had to be replaced
due to hardware breakage. It was replaced with a Raspberry-Pi 4.</p></li>
<li><p>Enhanced plugin documentation.</p></li>
<li><p>Added description of the git workflow to the Developer Manual.</p></li>
<li><p>Added checker script <code class="docutils literal notranslate"><span class="pre">check-nuitka-with-codespell</span></code> that reports
typos in the source code for easier use of <code class="docutils literal notranslate"><span class="pre">codespell</span></code> with Nuitka.</p></li>
<li><p>Use newest PyLint and clang-format.</p></li>
<li><p>Also check plugin documentation files for ReST errors.</p></li>
<li><p>Much enhanced support for Visual Code configuration.</p></li>
<li><p>Trigger module code is now written into the build directory in debug
mode, to aid debugging.</p></li>
<li><p>Added deep check function that descends into tuples to check their
elements too.</p></li>
</ul>
</div>
<div class="section" id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this headline"></a></h2>
<p>This release comes after a long time of 4 months without a release, and
has accumulated massive amounts of changes. The work on CPython 3.8 is
not yet complete, and the performance work has yet to show actual fruit,
but has also progressed on all fronts. Connecting the dots and pieces
seems not far away.</p>
</div>
</div>

<div class="section">
    

<div class="section">
  <span style="float: left">
     Previous:
    
    <a href="bksahus-gsoc-wrap-up.html">
       bksahu’s GSoC warp up
    </a>
    
  </span>
  <span>&nbsp;</span>
  <span style="float: right">
     Next: 
    <a href="nuitka-release-067.html">
      Nuitka Release 0.6.7 
    </a>
    
  </span>
</div>
  
</div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Kay Hayen and Nuitka Contributors.</p>
  </div>

  
<div class='share-button-container'>
    <div class="socialbutton-wrapper">
        <a href="https://twitter.com/share?url=https://nuitka.net/posts/nuitka-release-066.html&hashtags=nuitka" target="_blank">
            <div class="socialbutton twitter" data-share-url="https://nuitka.net">
                <p class="icon">
                    <img src="/_static/icon-twitter.png">
                </p>

                <p class="shares">share...</p>
            </div>
        </a>

        <a href="https://www.facebook.com/sharer.php?u=https://nuitka.net/posts/nuitka-release-066.html&hashtag=%23nuitka"  target="_blank">
            <div class="socialbutton facebook" data-share-url="https://nuitka.net">
                <p class="icon">
                    <img src="/_static/icon-facebook.png">
                </p>

                <p class="shares">share...</p>
            </div>
        </a>

        <a href="http://www.reddit.com/submit?url=https://nuitka.net/posts/nuitka-release-066.html" target="_blank">
            <div class="socialbutton reddit">
                <p class="icon">
                    <img src="/_static/icon-reddit.png">
                </p>

                <p class="shares">share...</p>
            </div>
        </a>
    </div>
</div>



</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>